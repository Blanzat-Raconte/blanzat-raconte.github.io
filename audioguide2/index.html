
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Blanzat Raconte moi une histoire">
      
      <link rel="icon" href="../assets/logo/blanzat-raconte.png">
    
    
    
      
        <title>Audioguide 2 (tag NFC) - Blanzat Raconte moi une histoire</title>
      
    
    
    <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
    
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../stylesheets/audioguide.css">
    
      <link rel="stylesheet" href="../stylesheets/access.css">
    
  
  </head>
  
  
  
  <body dir="ltr">
  
    <div data-md-component="skip">
      
    </div>
    
    
      
<header class="md-header">
  <nav class="md-header__inner md-grid">
    <a href="../index.html" title="Blanzat Raconte moi une histoire" class="md-header__button md-logo" aria-label="Blanzat Raconte moi une histoire" data-md-component="logo">
      
  <img src="../assets/logo/blanzat-raconte.png" alt="">

    </a>
    
    <div class="md-header__title">
      <span class="md-ellipsis">
        Blanzat Raconte moi une histoire
      </span>
    </div>
    
    
      
      
    
  </nav>
</header>
    
    
    <div class="md-container">
      
        
        

<!--  -->
<nav class="md-nav " data-md-level="0" role="navigation">
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    L'association
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../jardin.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Le jardin
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../acces.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Venir au jardin
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../jardin_plus.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Jardin, en savoir plus !
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../audioguide1/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Audioguide 1 (QRcode)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href="index.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Audioguide 2 (tag NFC)
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>  
      
      
      <main class="md-main" role="main">
      
        <article class="md-content__inner md-typeset">
          
            


  <h1>Audioguide 2 (tag NFC)</h1>

<div id="status"></div>
<h2>Comment faire ?</h2>
<p>
Il y a des poteaux en bois le long du chemin du jardin. Les poteaux sont reli√©s par une petite corde.
Certains poteaux ont un petit chapeau en plastique.
</p>
<p>
<strong>Placez votre t√©l√©phone sur le haut d'un chapeau pour √©couter un message sur les plantes qui sont proches.</strong>
</p>
<p>
Les sons durent moins de 1 minute (entre 15 secondes et 45 secondes).
</p>

<div class="player">
  <button id="playPauseBtn" disabled="true">‚ñ∂Ô∏è Play</button>
  <button id="restartBtn" disabled="true">üîÑ Rejouer</button>

  <div id="track-info">
    <h3 id="title"></h3>
    <img id="cover" src="" alt="">
  </div>
</div>

<script>
  let audio = null;
  let url = null;
  let isPlaying = false;
  const playPauseBtn = document.getElementById('playPauseBtn');
  const restartBtn = document.getElementById('restartBtn');
  const cover = document.getElementById('cover');

  function launch(audioFile, title, imageUrl, imageAlt) {
    // Si m√™me fichier ou temps de lecture < 3 secondes
    if (audioFile == url && isPlaying && audio.currentTime < 3)
      return;

    // Backup du nom de l'audio
    url = audioFile;

    // Si un son est d√©j√† en cours, on l'arr√™te
    if (audio) {
      audio.pause();
      audio.currentTime = 0;
    }

    // Cr√©e un nouvel objet Audio
    audio = new Audio(audioFile);
    audio.play();
    audio.pause();
    audio.play();
    isPlaying = true;

    // Met √† jour les infos affich√©es
    document.getElementById('title').textContent = title;

    cover.src = imageUrl;
    cover.alt = imageAlt;
    cover.style.display = "inline-block";

    // Met √† jour le texte du bouton Play/Pause
    playPauseBtn.textContent = "‚è∏Ô∏è Pause";

    // Active les boutons
    playPauseBtn.disabled = false;
    restartBtn.disabled = false;

    audio.addEventListener('ended', () => {
      isPlaying = false;
      playPauseBtn.textContent = "‚ñ∂Ô∏è Play";
      audio.currentTime = 0; // remet √† z√©ro par s√©curit√©
    });
  }

  // Bouton Play / Pause
  playPauseBtn.addEventListener('click', () => {
    if (!audio) return;
    if (isPlaying) {
      audio.pause();
      playPauseBtn.textContent = "‚ñ∂Ô∏è Play";
    } else {
      audio.play();
      playPauseBtn.textContent = "‚è∏Ô∏è Pause";
    }
    isPlaying = !isPlaying;
  });

  // Bouton Restart
  restartBtn.addEventListener('click', () => {
    if (!audio) return;
    audio.currentTime = 0;
    audio.play();
    isPlaying = true;
    playPauseBtn.textContent = "‚è∏Ô∏è Pause";
  });

</script>

<script>
var ChromeSamples = {
  log: function() {
    var line = Array.prototype.slice.call(arguments).map(function(argument) {
      return typeof argument === 'string' ? argument : JSON.stringify(argument);
    }).join(' ');

    document.querySelector('#log').textContent += line + '\n';
  },

  clearLog: function() {
    document.querySelector('#log').textContent = '';
  },

  setStatus: function(status) {
    document.querySelector('#status').textContent = status;
  }
};
</script>

<h3>Infos</h3>
<div id="output" class="output">
  <div id="status"></div>
  <pre id="log"></pre>
</div>

<script>
if (/Chrome\/(\d+\.\d+.\d+.\d+)/.test(navigator.userAgent)){
// Let's log a warning if the sample is not supposed to execute on this
// version of Chrome.
if (89 > parseInt(RegExp.$1)) {
  ChromeSamples.setStatus('Warning! Keep in mind this sample has been tested with Chrome ' + 89 + '.');
  }
}
// Add a global error event listener early on in the page load, to help ensure that browsers
// which don't support specific functionality still end up displaying a meaningful message.
window.addEventListener('error', function(error) {
  if (ChromeSamples && ChromeSamples.setStatus) {
    console.error(error);
    ChromeSamples.setStatus(error.message + ' (Your browser may not support this feature.)');
    error.preventDefault();
  }
});
</script>

<script type="module">
  import {nfcDict} from "./nfcDict.js";
  import {audioDict} from "./audioDict.js";
  window.nfcDict = nfcDict;
  window.audioDict = audioDict;
</script>

<script>
log = ChromeSamples.log;
if (!("NDEFReader" in window)){
  ChromeSamples.setStatus("Cette page ne fonctionnera pas. Il faut utiliser le navigateur Chrome sur un t√©l√©phone Android pour que cela fonctionne.");
  }
  // console.log(audioDict);
  const preUrl = "https://blanzat-raconte.github.io/audio/";

async function startScan() {
  // log("starting scan");

  try {
    const ndef = new NDEFReader();
    await ndef.scan();
    // log("> Scan started");

    ndef.addEventListener("readingerror", () => {
      log("Erreur de lecture du tag NFC.");
    });

    ndef.addEventListener("reading", ({ message, serialNumber }) => {
      // log(`> Tag: ${serialNumber}`);
      // log(`> Records: (${message.records.length})`);
      const audioId = nfcDict[serialNumber];
      const audioUrl = preUrl + audioId + ".mp3"
      // log (`> Id: ${audioId}`);
      launch(audioUrl, audioDict[audioId].name, audioDict[audioId].imgSrc, audioDict[audioId].imgAlt);
    });
  } catch (error) {
    log("Argh! " + error);
  }
}
startScan();

</script>





          
        </article>
        
        
      </main>
    
      
    </div>
  
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../javascripts/extra.js"></script>
      
        <script src="../javascripts/a11y-dialog.min.js"></script>
      
    
  </body>
</html>